# Online Payments Fraud Detection

## Project Overview
This project aims to detect fraudulent online payment transactions using machine learning. It involves comprehensive data preprocessing, exploratory data analysis (EDA), training various classification models, and deploying the best-performing model as a Flask web application for real-time predictions.

## Features
-   **Data Acquisition:** Download and load the `PS_20174392719_1491204439457_log.csv` dataset.
-   **Data Preprocessing:** Handles missing values, performs feature engineering (label encoding for categorical features), and drops irrelevant columns.
-   **Exploratory Data Analysis (EDA):** Generates various plots (histograms, box plots, count plots, correlation heatmaps, joint plots, violin plots) to understand data distribution, relationships, and outliers. All generated plots are saved to the `training/plots` directory.
-   **Model Training & Evaluation:** Trains and evaluates multiple machine learning classifiers (Random Forest, Decision Tree, Extra Trees, SVC, XGBoost) on the preprocessed data. The best-performing model is selected and saved.
-   **Model Persistence:** The trained model is saved using `pickle` for later use in the web application.
-   **Flask Web Application:** A user-friendly web interface built with Flask allows users to input transaction details and receive fraud predictions.

## Dataset
The dataset used in this project is `Online Payments Fraud Detection Dataset` (`PS_20174392719_1491204439457_log.csv`), available on Kaggle. It contains various features related to online payment transactions, including `step`, `type`, `amount`, `oldbalanceOrg`, `newbalanceOrig`, `oldbalanceDest`, `newbalanceDest`, `isFraud`, and `isFlaggedFraud`.

**Download Link:** [Kaggle Dataset](https://www.kaggle.com/datasets/rupakroy/online-payments-fraud-detection-dataset)

**Note:** You need to manually download the dataset from the link above and place the `PS_20174392719_1491204439457_log.csv` file into the `data/` directory.

## Installation

1.  **Clone the repository:**
    ```bash
    # Assuming your project is already set up and you are in the root directory
    ```

2.  **Create project directories:**
    The project expects the following directory structure. These should have been created for you.
    ```
    .
    ├── data/
    ├── flask/
    │   └── templates/
    └── training/
        └── plots/
    ```

3.  **Install Python dependencies:**
    It is recommended to use a virtual environment.
    ```bash
    pip install -r requirements.txt
    ```

## Usage

### 1. Model Training and EDA

To run the data preprocessing, EDA, and train the machine learning model:

1.  Ensure you have downloaded the dataset and placed it in the `data/` directory as `PS_20174392719_1491204439457_log.csv`.
2.  Navigate to the project's root directory.
3.  Run the training script:
    ```bash
    python training/train_model.py
    ```
    This script will:
    -   Perform data loading, preprocessing, and feature engineering.
    -   Generate and save various EDA plots into the `training/plots/` directory.
    -   Train an XGBoost classifier (other models are commented out for faster execution).
    -   Evaluate the model and save the trained model as `payments.pkl` in the `training/` directory.

### 2. Running the Flask Web Application

After training the model and generating `payments.pkl`, you can run the Flask application:

1.  Copy the `payments.pkl` file from the `training/` directory to the `flask/` directory.
    ```bash
    cp training/payments.pkl flask/payments.pkl
    ```
2.  Navigate to the `flask/` directory:
    ```bash
    cd flask
    ```
3.  Run the Flask application:
    ```bash
    python app.py
    ```
4.  Open your web browser and go to the URL provided in the terminal (usually `http://127.0.0.1:5000/` or `http://localhost:5000/`).

## Project Structure

```
.
├── data/
│   └── PS_20174392719_1491204439457_log.csv  # Downloaded dataset
├── flask/
│   ├── templates/
│   │   ├── home.html
│   │   ├── predict.html
│   │   └── submit.html
│   ├── app.py                          # Flask application script
│   └── payments.pkl                    # Trained machine learning model
├── training/
│   ├── ONLINE PAYMENTS FRAUD DETECTION.ipynb (Optional - if notebook was used for development)
│   ├── payments.pkl                    # Trained model (generated by train_model.py)
│   ├── train_model.py                  # Script for data processing, EDA, and model training
│   └── plots/                          # Directory to store generated EDA plots
└── project requirements.txt            # Original project requirements
```

## Models Used (in `train_model.py`)
-   Random Forest Classifier (commented out by default)
-   Decision Tree Classifier (commented out by default)
-   Extra Trees Classifier (commented out by default)
-   Support Vector Machine (SVC) (commented out by default due to computational intensity)
-   **XGBoost Classifier (default for training)**

## Results
The XGBoost Classifier demonstrated high accuracy in detecting fraudulent transactions. Detailed metrics (confusion matrix, classification report, accuracy score, cross-validation scores) are printed during the `train_model.py` execution.

## Technologies
-   Python 3.x
-   Pandas
-   NumPy
-   Matplotlib
-   Seaborn
-   Scikit-learn
-   XGBoost
-   Flask
-   Bootstrap 5 (for frontend styling)

## License
This project is for educational and demonstrative purposes. No specific license is attached; feel free to use and modify.
